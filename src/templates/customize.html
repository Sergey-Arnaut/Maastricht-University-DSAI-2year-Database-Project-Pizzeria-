{% extends "base.html" %}
{% block title %}Customize {{ pizza.name }}{% endblock %}
{% block content %}
<h1>Customize: {{ pizza.name }} ({{ pizza.size }})</h1>
<p class="text-muted mb-2">
  Base price: <strong>{{ base_price }}</strong> €
  {% if pizza.is_vegan %} · <span class="badge bg-success">Vegan</span>{% endif %}
  {% if pizza.is_vegetarian and not pizza.is_vegan %} · <span class="badge bg-info">Vegetarian</span>{% endif %}
</p>

<form method="post" class="mt-3">
  {% csrf_token %}
  <div class="row g-3">
    {% for ing in ingredients %}
      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between">
              <strong>{{ ing.name }}</strong>
              <small class="text-muted">{{ ing.price_per_unit }} €/unit</small>
            </div>
            <label class="form-label mt-2">Units to add</label>
            <input type="number" min="0" value="0" name="ing_{{ ing.ingredient_id }}" class="form-control" />
            {% if pizza.is_vegan and not ing.vegan %}
              <small class="text-danger">Not allowed for vegan</small>
            {% elif pizza.is_vegetarian and not ing.vegetarian %}
              <small class="text-danger">Not allowed for vegetarian</small>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <div class="d-flex gap-3 mt-4">
    <div>
      <label class="form-label">Quantity of pizzas</label>
      <input type="number" min="1" value="1" name="qty" class="form-control" style="max-width:120px;">
    </div>
    <div class="align-self-end">
      <button class="btn btn-danger">Add customized pizza to cart</button>
    </div>
  </div>
</form>

<p class="mt-3"><a href="{% url 'menu' %}" class="btn btn-outline-secondary">Back to menu</a></p>
{% endblock %}
